---
import ModelCard from './ModelCard.astro';

interface Props {
  id: string;
  name: string;
  npm: string;
  doc: string;
  hasLogo: boolean;
  modelCount: number;
  models: Array<{
    id: string;
    name: string;
    family?: string;
    provider: string;
    release_date: string;
    reasoning: boolean;
    tool_call: boolean;
    attachment: boolean;
    open_weights: boolean;
    structured_output?: boolean;
    temperature?: boolean;
    knowledge?: string;
    status?: string;
    modalities: { input: string[]; output: string[] };
    limit: { context: number; output: number; input?: number };
    cost?: { input?: number; output?: number };
  }>;
}

const { id, name, npm, doc, modelCount, models } = Astro.props;

const countLabel = `(${modelCount} ${modelCount === 1 ? 'model' : 'models'})`;
---

<section
  id={id}
  class="mb-20 scroll-mt-28"
  data-provider-section
  data-provider-name={name.toLowerCase()}
>
  <header class="reveal">
    <div class="flex flex-wrap items-baseline justify-between gap-x-6 gap-y-3">
      <div class="flex flex-wrap items-baseline gap-x-3 gap-y-2">
        <h2 class="font-serif text-2xl md:text-3xl text-cream font-light">
          {name}
        </h2>
        <span class="font-sans text-sm text-gold-muted">
          {countLabel}
        </span>
      </div>

      {doc && (
        <a
          href={doc}
          target="_blank"
          rel="noopener noreferrer"
          class="group inline-flex items-center gap-2 text-gold text-xs font-sans tracking-widest-plus uppercase border-b border-transparent hover:border-gold-light hover:text-gold-light transition-all duration-300"
        >
          Docs
          <span class="inline-flex transition-transform duration-300 group-hover:translate-x-0.5" aria-hidden="true">
            <svg class="h-4 w-4" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M7 17L17 7" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" />
              <path
                d="M9 7h8v8"
                stroke="currentColor"
                stroke-width="1.5"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </svg>
          </span>
        </a>
      )}
    </div>

    <div class="mt-3 flex flex-wrap items-center gap-3">
      {npm && <span class="text-silver/80 font-mono text-xs">{npm}</span>}
    </div>

    <div class="gold-rule w-full mt-4" />
  </header>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
    {models.map((model, index) => {
      const delay = Math.min(index * 0.06, 0.45);

      return (
        <div class="reveal" style={`transition-delay: ${delay}s;`}>
          <ModelCard
            id={model.id}
            name={model.name}
            family={model.family}
            provider={model.provider}
            releaseDate={model.release_date}
            reasoning={model.reasoning}
            toolCall={model.tool_call}
            attachment={model.attachment}
            openWeights={model.open_weights}
            structuredOutput={model.structured_output}
            temperature={model.temperature}
            knowledge={model.knowledge}
            status={model.status}
            modalities={model.modalities}
            limit={model.limit}
            cost={model.cost}
          />
        </div>
      );
    })}
  </div>
</section>
