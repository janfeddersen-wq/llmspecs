---
import SkillCard from './SkillCard.astro';

interface Props {
  name: string;
  slug: string;
  skillCount: number;
  skills: Array<{
    name: string;
    description: string;
    group: string;
    download_url: string;
    zip_size_bytes: number;
    file_count: number;
    contents: {
      has_scripts: boolean;
      has_references: boolean;
      has_license: boolean;
    };
  }>;
}

const { name, slug, skillCount, skills } = Astro.props;

function titleCase(value: string): string {
  return value
    .split(/[-\s]+/)
    .filter(Boolean)
    .map((word) => word.charAt(0).toUpperCase() + word.slice(1).toLowerCase())
    .join(' ');
}

const displayName = titleCase(name);
const countLabel = `(${skillCount} ${skillCount === 1 ? 'skill' : 'skills'})`;
---

<section id={slug} class="mb-20 scroll-mt-28">
  <header class="reveal">
    <div class="flex flex-wrap items-baseline gap-x-3 gap-y-2">
      <h2 class="font-serif text-2xl md:text-3xl text-cream font-light">
        {displayName}
      </h2>
      <span class="font-sans text-sm text-gold-muted">
        {countLabel}
      </span>
    </div>

    <div class="gold-rule w-full mt-4" />
  </header>

  <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
    {skills.map((skill, index) => {
      const delay = Math.min(index * 0.1, 0.5);

      return (
        <div class="reveal" style={`transition-delay: ${delay}s;`}>
          <SkillCard
            name={skill.name}
            description={skill.description}
            group={skill.group}
            downloadUrl={skill.download_url}
            zipSizeBytes={skill.zip_size_bytes}
            fileCount={skill.file_count}
            contents={skill.contents}
          />
        </div>
      );
    })}
  </div>
</section>
